{
    "scrape_url": "https://scrape.pastebin.com/api_scrape_item.php?i=D7q1axL5",
    "full_url": "https://pastebin.com/D7q1axL5",
    "date": "1594631652",
    "key": "D7q1axL5",
    "size": 4160,
    "expire": "1594632252",
    "title": "",
    "syntax": "python",
    "user": "Chiesonski",
    "filename": "D7q1axL5",
    "pasteid": "D7q1axL5",
    "pastesite": "pastebin.com",
    "@timestamp": "2020-07-13T09:14:12",
    "MD5": "bc3c2da048dbf9f087c4c723588bee49",
    "SHA256": "c024bfafa9abdceacb17699a60b3b8c23f2538c7286553815d023729d36bb6ab",
    "raw_paste": "import requests, random\r\nfrom time import sleep, strftime\r\nfrom threading import Thread\r\nfrom bs4 import BeautifulSoup\r\nfrom discord_webhook import DiscordWebhook, DiscordEmbed\r\nfrom retrying import retry\r\nfrom fake_useragent import UserAgent\r\n\r\nWEBHOOK = \"https://discordapp.com/api/webhooks/730535397209407649/5DHVnWIBzJuqX3EXORpTFtE-13IrK3UVC9VdujDAK6xIq3qfgSY3UPBqPpakV1KG7QFv\"\r\nERROR = \"https://discordapp.com/api/webhooks/729836943340470345/tcz_FHtpPyvxWOCN1h8HKafKpVNDsGUBzAonIpgub_jEzXSf8_tCSzUhlJlFtLtxRtSE\"\r\n\r\nclass Monitor(Thread):\r\n    def __init__(self, task: list, product_n: int):\r\n        Thread.__init__(self)\r\n        self.url = task[0]\r\n        self.price = task[1]\r\n        self.product_n = product_n\r\n        from fake_useragent import FakeUserAgentError                #! FIXME non riesce a generare l'ua\r\n        try:\r\n            self.userAgent = UserAgent(use_cache_server=False, verify_ssl=False).random\r\n            print(self.userAgent)\r\n        except FakeUserAgentError:\r\n            self.userAgent = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36 OPR/68.0.3618.191\"\r\n\r\n    @retry\r\n    def run(self):\r\n        while True:\r\n            try:\r\n                proxies = {'https':'http://SelTommasoboriassi:P0h2WqA@91.201.65.156:45785'}\r\n                r = requests.get(   self.url+\"?\"+str(random.randint(1,10000)),\r\n                                        headers={'User-Agent':self.userAgent},proxies = proxies )\r\n                soup = BeautifulSoup(r.content, 'lxml')\r\n\r\n                print(f\"{strftime('%H:%M:%S')}  [{self.product_n}]  {soup.title.text} -> {r.status_code}\")      #controllo errori\r\n                self.title = soup.find(\"h1\",class_ = \"a-size-large a-spacing-none\")\r\n                self.price = soup.find_all(\"span\",class_ = \"a-size-large a-color-price olpOfferPrice a-text-bold\")\r\n\r\n                try:\r\n                    self.img = soup.find(\"img\",alt=\"Torna alla pagina prodotto\")['src']\r\n                except:\r\n                    self.img = None\r\n\r\n                for element in soup.find_all(\"span\",class_ = \"a-size-large a-color-price olpOfferPrice a-text-bold\"):\r\n                    costo = price.text.replace(\"                EUR \",\"\")\r\n                    costo = costo.split(\",\", 1)[0]\r\n                    if costo < self.price:\r\n                        send_webhook(self)\r\n                        print(f\"{strftime('%H:%M:%S')}  [{self.product_n}]  [RESTOCK] {self.title}: {self.price}\")\r\n                        sleep(1)\r\n                sleep(0.1)\r\n            except:\r\n                print(f\"{strftime('%H:%M:%S')}  [{self.product_n}]  Nothing\")\r\n\r\n    def send_webhook(self):\r\n        webhook = DiscordWebhook(url=WEBHOOK, username=\"AMAZON Monitor\")\r\n        embed = DiscordEmbed(title=self.title,  color=14424279,url=self.url)\r\n        embed.set_footer(text='Powered by @GhostCopEU',icon_url=\"https://cdn.discordapp.com/attachments/694487965270802514/694552750377271446/logo_ghostcopeu_png.png\")\r\n        embed.set_image(url=self.img)\r\n        embed.add_embed_field(name='**Price**', value=self.price)\r\n        embed.set_timestamp()\r\n        webhook.add_embed(embed)\r\n        response = webhook.execute()\r\n\r\nif __name__ == \"__main__\":\r\n    print(f\"[AMAZON] Monitor started\")                      # ANCHOR Inserire dati per i prodotti\r\n    tasks = [   [\"https://amzn.to/2BHyW5J\" ,\"140\"],\r\n                [\"https://amzn.to/2ZbOHuA\" ,\"140\"],\r\n                [\"https://amzn.to/2AFBwsb\" ,\"140\"],\r\n                [\"https://amzn.to/2W0F1kn\" ,\"140\"],\r\n                [\"https://amzn.to/3edvnRU\" ,\"140\"],\r\n                [\"https://amzn.to/31WJcl1\" ,\"115\"],\r\n                [\"https://amzn.to/2ZM1wuy\" ,\"250\"],\r\n                [\"https://amzn.to/322fJGr\" ,\"290\"],\r\n                [\"https://amzn.to/3iG1WLE\" ,\"140\"],\r\n                [\"https://amzn.to/3iH8z0d\" ,\"200\"],\r\n                [\"https://amzn.to/2ZcR5kt\" ,\"120\"],\r\n                [\"https://amzn.to/3ehMqCc\" ,\"140\"]\r\n                    ]\r\n    task_list = [Monitor(tasks[i], i) for i in range(len(tasks))]\r\n    for thread in task_list:\r\n        thread.start()",
    "YaraRule": [
        "db_connection",
        "discord_api"
    ]
}