{
    "scrape_url": "https://scrape.pastebin.com/api_scrape_item.php?i=GkPR16e1",
    "full_url": "https://pastebin.com/GkPR16e1",
    "date": "1594458665",
    "key": "GkPR16e1",
    "size": 3710,
    "expire": "0",
    "title": "SSH Tor Hidden Service",
    "syntax": "bash",
    "user": "Vegeta_Ssj",
    "filename": "GkPR16e1",
    "pasteid": "GkPR16e1",
    "pastesite": "pastebin.com",
    "@timestamp": "2020-07-11T09:11:05",
    "MD5": "c80f20a0f6e3a3566b0bf2c17324e02c",
    "SHA256": "343e06d38f0d467b6942ef9de130e40b15330a06de7eb635156b96a7759e8540",
    "raw_paste": "First login, add non root user with sudo privileges:\r\n\r\nroot@debian:~# adduser exploit\r\n\r\nroot@debian:~# usermod -aG sudo exploit #or\r\nroot@debian:~# echo \"exploit  ALL=(ALL) NOPASSWD:ALL\" | sudo tee nano /etc/sudoers\r\n\r\nexploit@debian:~$ sudo whoami\r\n[sudo] password for exploit: \r\nroot\r\n\r\nGenerate rsa key pair (locally):\r\n\r\nexploit@host:~$ ssh-keygen -t rsa\r\n\r\nGenerating public/private rsa key pair.\r\nEnter file in which to save the key (/home/exploit/.ssh/id_rsa): \r\n\r\nSHA256:4yMuip+M6EHt0OBNN5lpg+15qIBf+cEwKr1YMy0qJpU exploit@host\r\n\r\nThe key's randomart image is:\r\n+---[RSA 2048]----+\r\n|                 |\r\n|    o +          |\r\n| . ooX           |\r\n|o.*++==          |\r\n|o=E+++o.S        |\r\n|.B+*...o .       |\r\n|=ooo  o o        |\r\n|=+.... . .       |\r\n|=o=. ..          |\r\n+----[SHA256]-----+\r\n\r\nCopy the key to the server:\r\n\r\nexploit@host:~$ ssh-copy-id exploit@vps_ip_adress\r\n\r\n/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys\r\nroot@185.234.52.201's password: \r\n\r\nTry logging in:\r\n\r\nexploit@host:~$ ssh exploit@vps_ip_adress\r\nEnter passphrase for key '/home/exploit/.ssh/id_rsa': \r\nexploit@debian:~# sudo apt update;sudo apt upgrade; sudo apt dist-upgrade; sudo apt install unzip sudo \r\n\r\nBasic hardening for the ssh configuration:\r\n\r\nexploit@debian:~# sudo nano /etc/ssh/sshd_config\r\n\r\nPort 58983\r\nPermitRootLogin no\r\nPasswordAuthentication no  \r\n\r\nexploit@debian:~# sudo service sshd restart\r\n\r\nInstall Tor with SdwDate\r\n\r\nexploit@debian:~$ sudo apt install tor\r\n\r\nexploit@debian:~$ wget https://www.whonix.org/patrick.asc\r\nexploit@debian:~$ sudo apt-key --keyring /etc/apt/trusted.gpg.d/whonix.gpg add ~/patrick.asc\r\nexploit@debian:~$ sudo echo \"deb https://deb.whonix.org buster main contrib non-free\" | sudo tee /etc/apt/sources.list.d/whonix.list\r\nexploit@debian:~$ sudo apt update;sudo apt install sdwdate\r\n\r\nConfigure Tor to use Ssh Hidden Service\r\n\r\nexploit@debian:~$ sudo nano /etc/tor/torrc\r\n\r\nHiddenServiceDir /var/lib/tor/hidden_service/\r\nHiddenServicePort 22 127.0.0.1:58983\r\n\r\nStart tor as Daemon and SdwDate\r\n\r\nexploit@debian:~$ sudo service tor restart\r\nexploit@debian:~$ ps aux | grep tor\r\ndebian-+ 17602 21.5  2.0  50488 41924 ?        Ss   09:52   0:00 /usr/bin/tor --defaults-torrc /usr/share/tor/tor-service-defaults-torrc -f /etc/tor/torrc --RunAsDaemon 0\r\nexploit  17604  0.0  0.0   6076   884 pts/2    S+   09:52   0:00 grep tor\r\nexploit@debian:~$ cat /var/lib/tor/hidden_service/hostname\r\ncat: /var/lib/tor/hidden_service/hostname: Permission denied\r\nexploit@debian:~$ sudo cat /var/lib/tor/hidden_service/hostname\r\nsoqvnoxoffmik6s2b7i6a3wjav4is4it3bna3a2yksqgy5rn5s2ziwid.onion\r\n\r\nexploit@debian:~$ sudo sdwdate \r\n\r\nInstall Ufw and deny incoming connections:\r\n\r\nexploit@debian:~$ sudo apt install ufw\r\nexploit@debian:~$ sudo ufw enable\r\n\r\nCommand may disrupt existing ssh connections. Proceed with operation (y|n)? y\r\nFirewall is active and enabled on system startup\r\n\r\nexploit@debian:~$ sudo ufw status verbose\r\n\r\nStatus: active\r\nLogging: on (low)\r\nDefault: deny (incoming), allow (outgoing), disabled (routed)\r\nNew profiles: skip\r\n\r\nTest SSH Hidden Service:\r\n\r\nexploit@host:~$ ssh exploit@soqvnoxoffmik6s2b7i6a3wjav4is4it3bna3a2yksqgy5rn5s2ziwid.onion\r\n\r\nThe authenticity of host 'soqvnoxoffmik6s2b7i6a3wjav4is4it3bna3a2yksqgy5rn5s2ziwid.onion (127.42.42.0)' can't be established.\r\nECDSA key fingerprint is SHA256:hrlaE8wKzgQ389+ZX0LDmUPa6lJ/LIoCB2EefoISdU0.\r\nAre you sure you want to continue connecting (yes/no)? yes\r\nWarning: Permanently added 'soqvnoxoffmik6s2b7i6a3wjav4is4it3bna3a2yksqgy5rn5s2ziwid.onion' (ECDSA) to the list of known hosts.\r\nEnter passphrase for key '/home/exploit/.ssh/id_rsa':",
    "YaraRule": [
        "onion_url",
        "core_keywords"
    ]
}